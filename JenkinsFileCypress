
pipeline{
    agent any

    options{
        ansiColor('xterm')
    }

    stages{
        stage('Build'){
            steps{
                bat "npm config set legacy-peer-deps true"
                bat "npm i"
                script{
                    env.JAVA_HOME ='C:/sdk/jdk-11.0.17'
                }
            }
        }
        stage('Generate Allure Report'){
            steps{
                script{
                     allure includeProperties: false, jdk: '', results: [[path: 'allure-results']]
                    if (currentBuild.result == 'SUCCESS') {
                      teamsSendNotification color: 'good', message: "Allure report: ${env.BUILD_URL}allure"
                    } else {
                      teamsSendNotification color: 'danger', message: "Allure report: ${env.BUILD_URL}allure"
                   }
                }
            }
        }
    }
}
